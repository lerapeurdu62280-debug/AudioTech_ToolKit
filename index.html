<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioTech ToolKit - Station Expert</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .chart-container { position: relative; width: 100%; height: 300px; max-height: 350px; }
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: #3b82f6; cursor: pointer; margin-top: -6px; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }
        .resistor-band { height: 40px; width: 12px; border-radius: 2px; }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 font-sans selection:bg-blue-500 selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- ICONS ---
        const Icons = {
            Note: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>,
            Zap: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Wave: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12h2.5L7 3l5 18 5-13 2.5 4H22"/></svg>,
            Chip: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M9 1v3"/><path d="M15 1v3"/><path d="M9 20v3"/><path d="M15 20v3"/><path d="M20 9h3"/><path d="M20 14h3"/><path d="M1 9h3"/><path d="M1 14h3"/></svg>,
            Shield: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
            Music: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>,
            Light: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 2a7 7 0 0 1 10 10c0 4.418-5 10-10 10S2 16.418 2 12A7 7 0 0 1 12 2z"/><path d="M12 8v4"/><path d="M8 12h8"/></svg>,
            Git: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>,
            Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        };

        // --- COMPONENTS ---

        const NotesModule = () => {
            const [note, setNote] = useState(() => localStorage.getItem('audio_toolkit_notes') || 
`--- IBIZA AMP300 - SUIVI ---
Date: ${new Date().toLocaleDateString()}

[ ] Inspection visuelle (Condensateurs bombés?)
[ ] Fusibles testés

MESURES:
- Rail V+:      V
- Rail V-:      V
- Offset G:     mV
- Offset D:     mV

PIÈCES À CHANGER:
- 
`);
            useEffect(() => localStorage.setItem('audio_toolkit_notes', note), [note]);
            return (
                <div className="h-full flex flex-col gap-4 animate-in fade-in duration-500">
                    <div className="flex justify-between items-center text-slate-400 text-sm">
                        <span>Sauvegarde locale automatique</span>
                        <span className="text-green-500 flex items-center gap-1"><Icons.Check/> Actif</span>
                    </div>
                    <textarea className="flex-1 w-full bg-slate-800 border border-slate-700 rounded-lg p-4 font-mono text-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none" value={note} onChange={(e) => setNote(e.target.value)} spellCheck="false"/>
                </div>
            );
        };

        const OhmModule = () => {
            const [values, setValues] = useState({ v: '', r: '', i: '', p: '' });
            const calculate = (type, val) => {
                const newVals = { ...values, [type]: val };
                const v = parseFloat(newVals.v), r = parseFloat(newVals.r);
                if (type === 'v' || type === 'r') { if (v && r) { newVals.i = (v / r).toFixed(3); newVals.p = ((v * v) / r).toFixed(2); } }
                setValues(newVals);
            };
            const Input = ({ label, k, unit }) => (
                <div className="bg-slate-800 p-4 rounded-lg border border-slate-700">
                    <label className="block text-slate-400 text-xs uppercase tracking-wider mb-2">{label}</label>
                    <div className="flex items-center gap-2">
                        <input type="number" value={values[k]} onChange={(e) => calculate(k, e.target.value)} className="w-full bg-transparent text-2xl font-mono text-white focus:outline-none" placeholder="0"/>
                        <span className="text-slate-500 font-bold">{unit}</span>
                    </div>
                </div>
            );
            return (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 h-full content-start">
                    <Input label="Tension (U)" k="v" unit="V" />
                    <Input label="Résistance (R)" k="r" unit="Ω" />
                    <Input label="Courant (I)" k="i" unit="A" />
                    <Input label="Puissance (P)" k="p" unit="W" />
                    <button onClick={() => setValues({ v: '', r: '', i: '', p: '' })} className="md:col-span-2 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg transition-colors">Tout Effacer</button>
                </div>
            );
        };

        const LedModule = () => {
            const [vs, setVs] = useState(12);
            const [vled, setVled] = useState(2.2);
            const [iled, setIled] = useState(20);
            
            const r = Math.round((vs - vled) / (iled / 1000));
            const p = (vs - vled) * (iled / 1000);
            
            return (
                <div className="space-y-6 animate-in fade-in duration-500">
                    <div className="bg-amber-900/20 border border-amber-800 p-4 rounded-lg">
                        <h3 className="text-amber-400 font-bold flex items-center gap-2"><Icons.Light/> Calculateur Résistance LED</h3>
                        <p className="text-amber-200 text-sm mt-1">Trouvez la résistance idéale pour protéger vos LEDs.</p>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="bg-slate-800 p-3 rounded-lg">
                            <label className="text-xs text-slate-400">Tension Source (V)</label>
                            <input type="number" value={vs} onChange={e => setVs(Number(e.target.value))} className="w-full bg-transparent text-white font-mono border-b border-slate-600 focus:border-blue-500 outline-none"/>
                        </div>
                        <div className="bg-slate-800 p-3 rounded-lg">
                            <label className="text-xs text-slate-400">Tension LED (V)</label>
                            <input type="number" value={vled} onChange={e => setVled(Number(e.target.value))} className="w-full bg-transparent text-white font-mono border-b border-slate-600 focus:border-blue-500 outline-none"/>
                        </div>
                        <div className="bg-slate-800 p-3 rounded-lg">
                            <label className="text-xs text-slate-400">Courant LED (mA)</label>
                            <input type="number" value={iled} onChange={e => setIled(Number(e.target.value))} className="w-full bg-transparent text-white font-mono border-b border-slate-600 focus:border-blue-500 outline-none"/>
                        </div>
                    </div>
                    <div className="grid grid-cols-2 gap-4 mt-4">
                        <div className="text-center p-6 bg-slate-800 rounded-lg border border-slate-700">
                            <div className="text-slate-400 text-xs uppercase mb-2">Résistance Recommandée</div>
                            <div className="text-4xl font-bold text-white font-mono">{r} Ω</div>
                        </div>
                        <div className="text-center p-6 bg-slate-800 rounded-lg border border-slate-700">
                            <div className="text-slate-400 text-xs uppercase mb-2">Puissance Dissipée</div>
                            <div className="text-4xl font-bold text-amber-500 font-mono">{p.toFixed(2)} W</div>
                        </div>
                    </div>
                </div>
            );
        };

        const FilterModule = () => {
            const [r, setR] = useState(10000);
            const [c, setC] = useState(0.1);
            const chartRef = useRef(null);
            const chartInstance = useRef(null);
            const fc = useMemo(() => 1 / (2 * Math.PI * r * (c / 1000000)), [r, c]);

            useEffect(() => {
                if (chartInstance.current) chartInstance.current.destroy();
                const ctx = chartRef.current.getContext('2d');
                const labels = [10, 100, 1000, 10000, 20000];
                const dataPoints = labels.map(f => -10 * Math.log10(1 + Math.pow(f / fc, 2)));
                chartInstance.current = new Chart(ctx, {
                    type: 'line',
                    data: { labels, datasets: [{ label: 'Gain (dB)', data: dataPoints, borderColor: '#3b82f6', backgroundColor: 'rgba(59, 130, 246, 0.1)', borderWidth: 2, fill: true, tension: 0.4 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { type: 'logarithmic', grid: { color: '#334155' } }, y: { grid: { color: '#334155' } } } }
                });
                return () => { if (chartInstance.current) chartInstance.current.destroy(); }
            }, [fc]);

            return (
                <div className="flex flex-col gap-6 h-full">
                    <div className="grid grid-cols-2 gap-4">
                        <div className="bg-slate-800 p-3 rounded-lg"><label className="text-xs text-slate-400">R (Ω)</label><input type="number" value={r} onChange={e => setR(Number(e.target.value))} className="w-full bg-transparent text-white font-mono border-b border-slate-600 outline-none"/></div>
                        <div className="bg-slate-800 p-3 rounded-lg"><label className="text-xs text-slate-400">C (µF)</label><input type="number" value={c} onChange={e => setC(Number(e.target.value))} className="w-full bg-transparent text-white font-mono border-b border-slate-600 outline-none"/></div>
                    </div>
                    <div className="flex-1 bg-slate-900 rounded-lg border border-slate-800 p-2"><div className="chart-container"><canvas ref={chartRef}></canvas></div></div>
                    <div className="text-center p-4 bg-slate-800 rounded-lg border border-slate-700"><div className="text-slate-400 text-xs uppercase">Fréquence de Coupure (-3dB)</div><div className="text-3xl font-bold text-green-400 font-mono">{fc.toFixed(1)} Hz</div></div>
                </div>
            );
        };

        const ComponentsModule = () => {
            const [bands, setBands] = useState(['brown', 'black', 'red', 'gold']);
            const colors = { black: { val: 0, mult: 1, bg: 'bg-black' }, brown: { val: 1, mult: 10, bg: 'bg-amber-900' }, red: { val: 2, mult: 100, bg: 'bg-red-600' }, orange: { val: 3, mult: 1000, bg: 'bg-orange-500' }, yellow: { val: 4, mult: 10000, bg: 'bg-yellow-400' }, green: { val: 5, mult: 100000, bg: 'bg-green-600' }, blue: { val: 6, mult: 1000000, bg: 'bg-blue-600' }, violet: { val: 7, mult: 10000000, bg: 'bg-violet-600' }, gray: { val: 8, mult: 100000000, bg: 'bg-gray-500' }, white: { val: 9, mult: 1000000000, bg: 'bg-white' }, gold: { mult: 0.1, tol: '5%', bg: 'bg-yellow-600' }, silver: { mult: 0.01, tol: '10%', bg: 'bg-slate-400' } };
            const calculateRes = () => { const val = (colors[bands[0]].val * 10 + colors[bands[1]].val) * colors[bands[2]].mult; return val >= 1000 ? (val / 1000) + ' kΩ' : val + ' Ω'; };
            return (
                <div className="space-y-6">
                    <div className="bg-slate-800 p-6 rounded-xl border border-slate-700 flex flex-col items-center">
                        <div className="w-full max-w-xs h-16 bg-amber-100/10 rounded-full flex items-center justify-center gap-4 relative border border-slate-600 mb-6"><div className="absolute w-full h-1 bg-slate-500 -z-10"></div>{bands.map((b, i) => (<div key={i} className={`resistor-band ${colors[b].bg} shadow-lg`}></div>))}</div>
                        <div className="text-3xl font-mono font-bold text-white mb-4">{calculateRes()}</div>
                        <div className="grid grid-cols-4 gap-2 w-full">{bands.map((b, i) => (<select key={i} value={b} onChange={(e) => { const n = [...bands]; n[i] = e.target.value; setBands(n); }} className="bg-slate-900 text-xs text-white border border-slate-600 rounded p-2">{Object.keys(colors).map(c => <option key={c} value={c}>{c}</option>)}</select>))}</div>
                    </div>
                    <div className="bg-slate-800 p-6 rounded-xl border border-slate-700"><h3 className="text-slate-400 text-xs uppercase mb-4">Transistors de Puissance (2SC5200)</h3><div className="flex items-center justify-between font-mono text-sm text-slate-300"><div className="flex flex-col items-center gap-1"><div className="w-3 h-8 bg-slate-600 rounded-sm"></div><span>1. Base</span></div><div className="flex flex-col items-center gap-1"><div className="w-3 h-8 bg-slate-600 rounded-sm"></div><span>2. Collecteur</span></div><div className="flex flex-col items-center gap-1"><div className="w-3 h-8 bg-slate-600 rounded-sm"></div><span>3. Émetteur</span></div></div></div>
                </div>
            );
        };

        const SafetyModule = () => {
             const [cap, setCap] = useState(4700);
             const time = (cap * 0.000001 * 1000 * 5).toFixed(1);
             return (
                 <div className="space-y-6">
                    <div className="bg-red-900/20 border border-red-800/50 p-4 rounded-lg"><h3 className="text-red-400 font-bold flex items-center gap-2"><Icons.Shield/> Danger Haute Tension</h3><p className="text-red-200 text-sm mt-1">Les condensateurs restent chargés. Attendez :</p></div>
                    <div className="bg-slate-800 p-6 rounded-xl text-center"><label className="text-slate-400 text-xs">Capacité (µF)</label><input type="number" value={cap} onChange={e=>setCap(e.target.value)} className="w-full bg-slate-900 border border-slate-700 p-2 rounded text-center text-white my-2"/><div className="mt-4"><div className="text-4xl font-bold text-white font-mono">{time}s</div></div></div>
                 </div>
             )
        }

        const SignalModule = () => {
            const [freq, setFreq] = useState(1000);
            const [playing, setPlaying] = useState(false);
            const ctx = useRef(null); const osc = useRef(null);
            const toggle = () => { if(playing) { osc.current.stop(); setPlaying(false); } else { ctx.current = new (window.AudioContext || window.webkitAudioContext)(); osc.current = ctx.current.createOscillator(); const gain = ctx.current.createGain(); gain.gain.value = 0.1; osc.current.frequency.value = freq; osc.current.connect(gain); gain.connect(ctx.current.destination); osc.current.start(); setPlaying(true); } };
            useEffect(() => { if(playing && osc.current) osc.current.frequency.value = freq; }, [freq]);
            return (
                <div className="h-full flex flex-col items-center justify-center bg-slate-800 rounded-xl border border-slate-700 p-6">
                    <div className="text-6xl font-mono font-bold text-cyan-400 mb-8">{freq} Hz</div>
                    <input type="range" min="20" max="2000" value={freq} onChange={e=>setFreq(e.target.value)} className="w-full mb-8"/>
                    <button onClick={toggle} className={`w-20 h-20 rounded-full flex items-center justify-center text-white font-bold transition-all shadow-xl ${playing ? 'bg-red-500 shadow-red-500/50' : 'bg-cyan-500 shadow-cyan-500/50'}`}>{playing ? 'STOP' : 'PLAY'}</button>
                </div>
            )
        }

        const DeploymentGuide = () => (
            <div className="space-y-6 h-full overflow-y-auto pr-2">
                <div className="bg-gradient-to-r from-blue-900 to-slate-900 p-6 rounded-xl border border-blue-800"><h3 className="text-xl font-bold text-white mb-2">Aide au déploiement</h3><p className="text-blue-200 text-sm">Votre site semble déjà actif ! Si le lien ne marche pas, essayez en navigation privée.</p></div>
                <div className="flex gap-4 items-start"><div className="bg-slate-800 w-8 h-8 rounded-full flex items-center justify-center font-bold text-blue-400 shrink-0">1</div><div><h4 className="font-bold text-slate-200">Lien du site</h4><p className="text-sm text-slate-400">https://lerapeurdu62280-debug.github.io/SOS-INFO-LUDO/</p></div></div>
            </div>
        );

        const App = () => {
            const [activeTab, setActiveTab] = useState('notes');
            const tabs = [
                { id: 'notes', label: 'Notes', icon: Icons.Note },
                { id: 'ohm', label: 'Calculs', icon: Icons.Zap },
                { id: 'led', label: 'LED', icon: Icons.Light },
                { id: 'filter', label: 'Filtres', icon: Icons.Wave },
                { id: 'comp', label: 'Compo.', icon: Icons.Chip },
                { id: 'safety', label: 'Sécurité', icon: Icons.Shield },
                { id: 'signal', label: 'Signal', icon: Icons.Music },
                { id: 'guide', label: 'Aide', icon: Icons.Git, color: 'text-slate-500' },
            ];

            return (
                <div className="min-h-screen bg-slate-950 flex flex-col items-center py-8 px-4">
                    <header className="w-full max-w-4xl mb-8 flex flex-col md:flex-row justify-between items-center gap-4">
                        <div><h1 className="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">AudioTech Hub</h1><p className="text-slate-500 text-xs tracking-widest uppercase">SOS-INFO-LUDO • Pro Edition</p></div>
                        <div className="flex flex-wrap justify-center gap-2 bg-slate-900 p-2 rounded-xl border border-slate-800">{tabs.map(t => (<button key={t.id} onClick={() => setActiveTab(t.id)} className={`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${activeTab === t.id ? (t.color || 'bg-slate-800 text-blue-400 shadow-sm border border-slate-700') : 'text-slate-500 hover:text-slate-300'}`}><t.icon /><span className="hidden sm:inline">{t.label}</span></button>))}</div>
                    </header>
                    <main className="w-full max-w-4xl bg-slate-900 rounded-2xl border border-slate-800 shadow-2xl p-6 min-h-[500px]">
                        {activeTab === 'notes' && <NotesModule />}
                        {activeTab === 'ohm' && <OhmModule />}
                        {activeTab === 'led' && <LedModule />}
                        {activeTab === 'filter' && <FilterModule />}
                        {activeTab === 'comp' && <ComponentsModule />}
                        {activeTab === 'safety' && <SafetyModule />}
                        {activeTab === 'signal' && <SignalModule />}
                        {activeTab === 'guide' && <DeploymentGuide />}
                    </main>
                    <footer className="mt-8 text-slate-600 text-xs text-center"><p>Outil généré pour l'assistance technique audio. Fonctionne hors ligne.</p></footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
